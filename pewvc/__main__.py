import numpy as np
import matplotlib.pyplot as plt
#from funcBox import *
import time

class Toolbox:
	'''Helper functions for the computation of pressure equations'''

	@staticmethod
	def axisAverage(array,a,b,avType=0):
		'''Returns the average value between array[a] and array[b]
		Input: array [...], a and b positive integers'''

		if avType==0: # arithmetic mean
			return 0.5*(array[a]+array[b])
		if avType==1: # geometric mean
			return (array[a]*array[b])**0.5
		if avType==2: # harmonic mean
			if array[a]==0 or array[b]==0:
				return 0.5*(array[a]+array[b])
			return 2*array[a]*array[b]/(array[a]+array[b])

	def surf(matrixList):
		'''Plots multiple surface plots in the same figure'''
		fig = plt.figure()
		ax = fig.add_subplot(111, projection='3d')
		for matrix in matrixList:
			matrix = matrix.transpose()
			m = matrix.shape[0]
			

			x = range(m)
			y = range(m)
			X, Y = np.meshgrid(x, y)
			ax.plot_surface(X,Y,matrix)
		plt.show()
		return fig


class Mesh:
	def __init__(self, inner_size,k=lambda x,y: [1,1,1], bounds = [[0,1],[0,1]],neumannType=1):
		'''Initialize a square mesh of a given size and resolution, with a permeability tensor,
		to solve the generalized Poisson equation f = div(k*grad(p)) '''

		self.bounds = bounds # A nested list in the form [[x_0,x_1],[y_0,y_1]] where x_0 is minimum value and x_1 the maximum value
		self.kFunc = k # The permeability tensor in the form [kxx,kyy,kxy] 
		self.changeDimension(inner_size) 
		
		# Setting the boundary conditions (fixed)
		self.bVals= lambda x,y: [0,1,0,0] # Values at the four sides // 0 = left side, 1 = right side, 2 = bottom, 3 = up
		self.bTypes= [0,0,1,1] # Type of condition at the four sides (0=Diriclet, 1=Neumann)
		self.neumannType = neumannType # What kind of discretization is used for the Neumann conditions 1=first order, 2=second order

		self.counter = 0

		self.f = lambda x,y: 0 # Source term of the equation (if 0 the eq. is homogenous)
		self.p_ex = lambda x,y: 0 # The analytical solution to the PDE


	def changeDimension(self,m_new,stencil=0,permMatrix=0):
		'''Change dimensions of the grid'''
		self.stencil = stencil

		self.m = m_new
		self.dx = 1/(self.m+1)

		# Matrices to solve the discrete equation Ad = b
		self.A = np.zeros((m_new**2,m_new**2))
		self.b = np.zeros((m_new**2,1)) 
		self.d = np.zeros((m_new**2,1))

		self.w = np.zeros((self.m+2,self.m+2))
		self.w_ex = np.zeros((self.m+2,self.m+2))

		self.fillPerm(permMatrix)

	def setBoundaries(self,bVals,bTypes):
		'''Sets the boundary conditions for the problem'''	
		self.bVals = bVals # Values at the four sides // 0 = left side, 1 = right side, 2 = bottom, 3 = up
		self.bTypes = bTypes # Type of condition at the four sides (0=Diriclet, 1=Neumann)

	def setSource(self,f,p_exact):
		'''Defines the right hand side of the equation
		and exact solution p_exact'''
		self.f = f # Function in x and y
		self.p_ex = p_exact

	def xd(self,i,j):
		'''Convert integer indices (i,j) to coordinates in space'''
		if i in range(0,self.m+2):
			return [self.bounds[0][0] + i * self.dx,self.bounds[1][0] + j * self.dx]
		else:
			print(i,j)
			raise(ValueError)

	def li(self,i,j):
		'''Convert two-dimensional indices (i,j) to one-dimensional indices (k)'''
		if i in range(1,self.m+1) and j in range(1,self.m+1):
			k = (i-1)+(j-1)*self.m  
			return k
		else: 
			print(i,j)
			raise(ValueError)

	def Av(i,j,d):
		if d[1]==0: # x-direction
			return Toolbox.axisAverage(self.kxx(),i,i+d[0],avType=avType)
		elif d[0]==0: # y-direction
			return Toolbox.axisAverage(kxy[1],j,j+d[1],avType=avType)

	def fillPerm(self,permMatrix=0):
		'''Sets the averaging matrix for the given permeabilities.'''
		kxx = np.ones((self.m+2,self.m+2)) #Horizontal permeability
		kyy = np.ones((self.m+2,self.m+2)) #Vertical permeability
		kxy = np.ones((self.m+2,self.m+2)) #Diagonal permeability

		if isinstance(permMatrix,list)==True:
			kxx = permMatrix[0]
			kyy = permMatrix[1]
			kxy = permMatrix[2]

		else:
			for i in range(0,self.m+2):
				for j in range(0,self.m+2):
					kxx[i][j] = self.kFunc(self.bounds[0][0] + i * self.dx,self.bounds[1][0] + j * self.dx)[0]
					kyy[i][j] = self.kFunc(self.bounds[0][0] + i * self.dx,self.bounds[1][0] + j * self.dx)[1]
					kxy[i][j] = self.kFunc(self.bounds[0][0] + i * self.dx,self.bounds[1][0] + j * self.dx)[2]
					

		self.kxx = kxx
		self.kyy = kyy
		self.kxy = kxy


		if self.stencil==1: # MPFA Stencil from analytical coefficents
			self.s1 = lambda i,j: ((kxy[i,j]*(kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j] - kxy[i+1,j+1]**2*kxy[i,j] + kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j] + kxx[i,j+1]*kyy[i+1,j]*kxy[i,j] + kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j] + kxy[i,j+1]*kxy[i+1,j+1]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxx[i,j]*(kxx[i,j+1]*kyy[i,j+1]*kyy[i+1,j+1] - kyy[i+1,j+1]*kxy[i,j+1]**2 - kyy[i,j]*kxy[i+1,j+1]**2 - kyy[i+1,j]*kxy[i,j+1]**2 - kyy[i,j+1]*kxy[i+1,j+1]**2 + kxx[i+1,j+1]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kyy[i,j]*kyy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kxx[i+1,j] - kxy[i+1,j]) - kxy[i+1,j] - kxx[i+1,j] + ((kyy[i,j]*(kxx[i,j-1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j-1]*kxy[i,j]*kxy[i+1,j] + kxx[i,j]*kxy[i,j-1]*kxy[i+1,j-1] + kxx[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i,j]*(kxx[i,j-1]*kyy[i,j]*kxy[i+1,j] - kxy[i+1,j]*kxy[i,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxy[i,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kyy[i+1,j] + kxy[i+1,j]) - ((kxx[i+1,j]*(kxx[i,j-1]*kyy[i,j]*kxy[i+1,j] - kxy[i+1,j]*kxy[i,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxy[i,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i+1,j]*(kxx[i,j]*kxx[i,j-1]*kyy[i,j] - kxx[i,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kxy[i,j]**2 - kxx[i,j]*kxy[i,j-1]**2 + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kyy[i+1,j] + kxy[i+1,j]) - (kxx[i+1,j] + kxy[i+1,j])*((kxy[i+1,j]*(kxx[i,j-1]*kyy[i,j]*kxy[i+1,j] - kxy[i+1,j]*kxy[i,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxy[i,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxx[i+1,j]*(kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] - kyy[i+1,j]*kxy[i,j-1]**2 - kyy[i,j-1]*kxy[i+1,j-1]**2 - kyy[i+1,j-1]*kxy[i,j-1]**2 - kyy[i,j]*kxy[i+1,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1])) - (kxx[i+1,j] + kxy[i+1,j])*((kyy[i,j]*(kxx[i,j-1]*kyy[i+1,j]*kxy[i,j] - kxy[i,j]*kxy[i+1,j-1]**2 + kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j] + kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j] + kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j] + kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i,j]*(kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] - kyy[i+1,j]*kxy[i,j-1]**2 - kyy[i,j-1]*kxy[i+1,j-1]**2 - kyy[i+1,j-1]*kxy[i,j-1]**2 - kyy[i,j]*kxy[i+1,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1])) + ((kxy[i,j]*(kxx[i,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i+1,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i,j+1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxx[i,j]*(kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j] - kxy[i,j+1]**2*kxy[i+1,j] + kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i+1,j] + kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j] + kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kyy[i+1,j] - kxy[i+1,j]) - ((kyy[i,j+1]*(kxx[i,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i+1,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i,j+1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j+1]*(kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1] - kxy[i+1,j+1]*kxy[i,j]**2 + kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1] + kxx[i,j]*kyy[i,j]*kxy[i+1,j+1] + kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1] + kxy[i,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kyy[i+1,j] - kxy[i+1,j]) + ((kxy[i,j+1]*(kyy[i+1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j+1]*kxy[i+1,j+1]*kxy[i+1,j] + kyy[i+1,j]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i+1,j+1]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kyy[i,j+1]*(kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j] - kxy[i+1,j+1]**2*kxy[i,j] + kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j] + kxx[i,j+1]*kyy[i+1,j]*kxy[i,j] + kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j] + kxy[i,j+1]*kxy[i+1,j+1]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kxx[i+1,j] - kxy[i+1,j])
			self.s2 = lambda i,j: ((kxy[i,j]*(kxx[i,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i+1,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i,j+1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxx[i,j]*(kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j] - kxy[i,j+1]**2*kxy[i+1,j] + kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i+1,j] + kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j] + kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kyy[i+1,j+1] + kxy[i+1,j+1]) - ((kyy[i,j+1]*(kxx[i,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i+1,j]*kxy[i,j+1]*kxy[i+1,j+1] + kxx[i,j+1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j+1]*(kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1] - kxy[i+1,j+1]*kxy[i,j]**2 + kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1] + kxx[i,j]*kyy[i,j]*kxy[i+1,j+1] + kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1] + kxy[i,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kyy[i+1,j+1] + kxy[i+1,j+1]) + ((kxx[i,j]*(kyy[i+1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j+1]*kxy[i+1,j+1]*kxy[i+1,j] + kyy[i+1,j]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i+1,j+1]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j]*(kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1] + kxx[i,j]*kyy[i+1,j]*kxy[i,j+1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1] + kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kxx[i+1,j+1] + kxy[i+1,j+1]) + (kxx[i+1,j+1] + kxy[i+1,j+1])*((kyy[i,j+1]*(kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1] + kxx[i,j]*kyy[i+1,j]*kxy[i,j+1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1] + kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j+1]*(kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] - kyy[i+1,j+1]*kxy[i,j]**2 - kyy[i,j]*kxy[i+1,j]**2 - kyy[i+1,j]*kxy[i,j]**2 - kyy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kyy[i,j]*kyy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))
			self.s3 = lambda i,j: kxy[i,j+1] - kyy[i,j+1] + ((kyy[i,j+1]*(kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1] + kxx[i,j]*kyy[i+1,j]*kxy[i,j+1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1] + kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j+1]*(kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] - kyy[i+1,j+1]*kxy[i,j]**2 - kyy[i,j]*kxy[i+1,j]**2 - kyy[i+1,j]*kxy[i,j]**2 - kyy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kyy[i,j]*kyy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kxx[i,j+1] - kxy[i,j+1]) - ((kxy[i-1,j]*(kxx[i-1,j]*kxy[i-1,j+1]*kxy[i,j+1] + kxx[i,j]*kxy[i-1,j+1]*kxy[i,j+1] + kxx[i-1,j+1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxx[i-1,j]*(kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j] - kxy[i-1,j+1]**2*kxy[i,j] + kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j] + kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j] + kxx[i,j+1]*kyy[i-1,j]*kxy[i,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kyy[i,j+1] + kxy[i,j+1]) - ((kxx[i-1,j]*(kyy[i,j+1]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i-1,j]*(kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1] - kxy[i-1,j+1]*kxy[i,j]**2 + kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1] + kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1] + kxx[i,j]*kyy[i,j]*kxy[i-1,j+1] + kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kxx[i,j+1] + kxy[i,j+1]) - ((kxy[i,j]*(kyy[i,j+1]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kyy[i,j]*(kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i-1,j]**2 + kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1] + kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j+1] + kxy[i-1,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kxx[i,j+1] + kxy[i,j+1]) + ((kxy[i,j]*(kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j] - kxy[i-1,j+1]**2*kxy[i,j] + kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j] + kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j] + kxx[i,j+1]*kyy[i-1,j]*kxy[i,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kyy[i,j]*(kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1] - kxx[i-1,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kxy[i-1,j]**2 + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kyy[i,j+1] + kxy[i,j+1]) + ((kxx[i,j]*(kyy[i+1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j+1]*kxy[i+1,j+1]*kxy[i+1,j] + kyy[i+1,j]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i+1,j+1]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j]*(kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1] + kxx[i,j]*kyy[i+1,j]*kxy[i,j+1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1] + kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kxx[i,j+1] - kxy[i,j+1]) + ((kxx[i,j]*(kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j] - kxy[i+1,j+1]**2*kxy[i,j] + kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j] + kxx[i,j+1]*kyy[i+1,j]*kxy[i,j] + kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j] + kxy[i,j+1]*kxy[i+1,j+1]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kxy[i,j]*(kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1] - kxx[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j+1]*kxy[i+1,j]**2 - kxx[i+1,j]*kxy[i+1,j+1]**2 - kxx[i,j+1]*kxy[i+1,j]**2 + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kyy[i,j+1] - kxy[i,j+1]) - ((kxy[i,j+1]*(kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i+1,j]**2 + kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1] + kxx[i,j]*kyy[i+1,j]*kxy[i,j+1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1] + kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]) - (kyy[i,j+1]*(kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1] - kxx[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j+1]*kxy[i+1,j]**2 - kxx[i+1,j]*kxy[i+1,j+1]**2 - kxx[i,j+1]*kxy[i+1,j]**2 + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j]))/(kxy[i,j+1]**2*kxy[i+1,j]**2 + kxy[i+1,j+1]**2*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j+1]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j+1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j+1]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j+1]*kxy[i,j+1]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j+1]**2 - kxx[i+1,j+1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j+1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j+1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j+1]**2 + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j+1]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i+1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i,j]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j+1]*kxx[i+1,j]*kyy[i,j]*kyy[i+1,j] - 2*kxy[i,j+1]*kxy[i+1,j+1]*kxy[i,j]*kxy[i+1,j]))*(kyy[i,j+1] - kxy[i,j+1])
			self.s4 = lambda i,j: ((kyy[i,j]*(kxx[i-1,j]*kxy[i-1,j+1]*kxy[i,j+1] + kxx[i,j]*kxy[i-1,j+1]*kxy[i,j+1] + kxx[i-1,j+1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i,j]*(kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j] - kxy[i,j+1]**2*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j] + kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i-1,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kyy[i-1,j+1] - kxy[i-1,j+1]) - ((kxx[i-1,j]*(kyy[i,j+1]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i-1,j]*(kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1] - kxy[i-1,j+1]*kxy[i,j]**2 + kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1] + kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1] + kxx[i,j]*kyy[i,j]*kxy[i-1,j+1] + kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kxx[i-1,j+1] - kxy[i-1,j+1]) - ((kxy[i,j]*(kyy[i,j+1]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j+1]*kxy[i,j+1]*kxy[i,j] + kyy[i,j]*kxy[i-1,j+1]*kxy[i-1,j] + kyy[i-1,j]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kyy[i,j]*(kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1] - kxy[i,j+1]*kxy[i-1,j]**2 + kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1] + kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j+1] + kxy[i-1,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kxx[i-1,j+1] - kxy[i-1,j+1]) - ((kxx[i-1,j]*(kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j] - kxy[i,j+1]**2*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j] + kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i-1,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i-1,j]*(kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1] - kxx[i-1,j]*kxy[i,j+1]**2 - kxx[i,j+1]*kxy[i,j]**2 - kxx[i,j]*kxy[i,j+1]**2 - kxx[i-1,j+1]*kxy[i,j]**2 + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kyy[i-1,j+1] - kxy[i-1,j+1])
			self.s5 = lambda i,j: ((kxy[i,j]*(kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j] - kxy[i,j]*kxy[i-1,j-1]**2 + kxx[i,j-1]*kyy[i-1,j]*kxy[i,j] + kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j] + kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j] + kxy[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxx[i,j]*(kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] - kyy[i,j]*kxy[i-1,j-1]**2 - kyy[i-1,j-1]*kxy[i,j-1]**2 - kyy[i,j-1]*kxy[i-1,j-1]**2 - kyy[i-1,j]*kxy[i,j-1]**2 + kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kxx[i-1,j] - kxy[i-1,j]) - kxy[i-1,j] - kxx[i-1,j] + ((kyy[i,j]*(kxx[i-1,j]*kxy[i-1,j+1]*kxy[i,j+1] + kxx[i,j]*kxy[i-1,j+1]*kxy[i,j+1] + kxx[i-1,j+1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j+1]*kxy[i-1,j]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i,j]*(kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j] - kxy[i,j+1]**2*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j] + kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i-1,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kyy[i-1,j] + kxy[i-1,j]) - ((kxx[i-1,j]*(kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j] - kxy[i,j+1]**2*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j] + kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i-1,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i-1,j]*(kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1] - kxx[i-1,j]*kxy[i,j+1]**2 - kxx[i,j+1]*kxy[i,j]**2 - kxx[i,j]*kxy[i,j+1]**2 - kxx[i-1,j+1]*kxy[i,j]**2 + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]))*(kyy[i-1,j] + kxy[i-1,j]) - (kxx[i-1,j] + kxy[i-1,j])*((kxy[i-1,j]*(kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j] - kxy[i,j+1]**2*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j] + kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j] + kxx[i,j+1]*kyy[i,j]*kxy[i-1,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxx[i-1,j]*(kxx[i-1,j+1]*kyy[i-1,j+1]*kyy[i,j+1] - kyy[i,j+1]*kxy[i-1,j+1]**2 - kyy[i-1,j]*kxy[i,j+1]**2 - kyy[i,j]*kxy[i-1,j+1]**2 - kyy[i-1,j+1]*kxy[i,j+1]**2 + kxx[i,j+1]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kyy[i-1,j]*kyy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j])) - (kxx[i-1,j] + kxy[i-1,j])*((kyy[i,j]*(kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j] - kxy[i-1,j+1]**2*kxy[i,j] + kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j] + kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j] + kxx[i,j+1]*kyy[i-1,j]*kxy[i,j] + kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j]) - (kxy[i,j]*(kxx[i-1,j+1]*kyy[i-1,j+1]*kyy[i,j+1] - kyy[i,j+1]*kxy[i-1,j+1]**2 - kyy[i-1,j]*kxy[i,j+1]**2 - kyy[i,j]*kxy[i-1,j+1]**2 - kyy[i-1,j+1]*kxy[i,j+1]**2 + kxx[i,j+1]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kyy[i-1,j]*kyy[i,j]))/(kxy[i-1,j+1]**2*kxy[i,j]**2 + kxy[i,j+1]**2*kxy[i-1,j]**2 - kxx[i-1,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j+1]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j+1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j+1]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j+1]*kxy[i-1,j+1]**2 - kxx[i-1,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j+1]**2 - kxx[i,j+1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j+1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j+1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j+1]**2 + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j+1] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j+1]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i,j+1]*kyy[i-1,j] + kxx[i-1,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] + kxx[i,j+1]*kxx[i,j]*kyy[i-1,j]*kyy[i,j] - 2*kxy[i-1,j+1]*kxy[i,j+1]*kxy[i-1,j]*kxy[i,j])) + ((kxy[i,j]*(kxx[i-1,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxx[i,j]*(kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j] - kxy[i-1,j]*kxy[i,j-1]**2 + kxx[i,j-1]*kyy[i,j]*kxy[i-1,j] + kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j] + kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kyy[i-1,j] - kxy[i-1,j]) - ((kyy[i,j-1]*(kxx[i-1,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j-1]*(kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1] - kxy[i,j]**2*kxy[i-1,j-1] + kxx[i,j]*kyy[i,j]*kxy[i-1,j-1] + kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1] + kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kyy[i-1,j] - kxy[i-1,j]) + ((kxy[i,j-1]*(kyy[i,j]*kxy[i-1,j]*kxy[i-1,j-1] + kyy[i-1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i-1,j]*kxy[i-1,j-1] + kyy[i-1,j-1]*kxy[i,j]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kyy[i,j-1]*(kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j] - kxy[i,j]*kxy[i-1,j-1]**2 + kxx[i,j-1]*kyy[i-1,j]*kxy[i,j] + kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j] + kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j] + kxy[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kxx[i-1,j] - kxy[i-1,j])
			self.s6 = lambda i,j: ((kxy[i,j]*(kxx[i-1,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxx[i,j]*(kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j] - kxy[i-1,j]*kxy[i,j-1]**2 + kxx[i,j-1]*kyy[i,j]*kxy[i-1,j] + kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j] + kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kyy[i-1,j-1] + kxy[i-1,j-1]) - ((kyy[i,j-1]*(kxx[i-1,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i,j-1]*kxy[i-1,j]*kxy[i,j] + kxx[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j-1]*(kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1] - kxy[i,j]**2*kxy[i-1,j-1] + kxx[i,j]*kyy[i,j]*kxy[i-1,j-1] + kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1] + kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kyy[i-1,j-1] + kxy[i-1,j-1]) + ((kxx[i,j]*(kyy[i,j]*kxy[i-1,j]*kxy[i-1,j-1] + kyy[i-1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i-1,j]*kxy[i-1,j-1] + kyy[i-1,j-1]*kxy[i,j]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j]*(kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1] - kxy[i-1,j]**2*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kxx[i-1,j-1] + kxy[i-1,j-1]) + (kxx[i-1,j-1] + kxy[i-1,j-1])*((kyy[i,j-1]*(kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1] - kxy[i-1,j]**2*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j-1]*(kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] - kyy[i,j]*kxy[i-1,j]**2 - kyy[i-1,j-1]*kxy[i,j]**2 - kyy[i,j-1]*kxy[i-1,j]**2 - kyy[i-1,j]*kxy[i,j]**2 + kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kyy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))
			self.s7 = lambda i,j: kxy[i,j-1] - kyy[i,j-1] + ((kyy[i,j-1]*(kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1] - kxy[i-1,j]**2*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j-1]*(kxx[i-1,j]*kyy[i-1,j]*kyy[i,j] - kyy[i,j]*kxy[i-1,j]**2 - kyy[i-1,j-1]*kxy[i,j]**2 - kyy[i,j-1]*kxy[i-1,j]**2 - kyy[i-1,j]*kxy[i,j]**2 + kxx[i,j]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kyy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kxx[i,j-1] - kxy[i,j-1]) - ((kxy[i+1,j]*(kxx[i,j-1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j-1]*kxy[i,j]*kxy[i+1,j] + kxx[i,j]*kxy[i,j-1]*kxy[i+1,j-1] + kxx[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxx[i+1,j]*(kxx[i,j-1]*kyy[i+1,j]*kxy[i,j] - kxy[i,j]*kxy[i+1,j-1]**2 + kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j] + kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j] + kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j] + kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kyy[i,j-1] + kxy[i,j-1]) - ((kxx[i+1,j]*(kyy[i+1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j]*kxy[i+1,j]*kxy[i+1,j-1] + kyy[i+1,j-1]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i+1,j]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i+1,j]*(kxx[i,j]*kyy[i,j]*kxy[i+1,j-1] - kxy[i,j]**2*kxy[i+1,j-1] + kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1] + kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1] + kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1] + kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kxx[i,j-1] + kxy[i,j-1]) - ((kxy[i,j]*(kyy[i+1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j]*kxy[i+1,j]*kxy[i+1,j-1] + kyy[i+1,j-1]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i+1,j]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kyy[i,j]*(kxx[i,j]*kyy[i+1,j]*kxy[i,j-1] - kxy[i+1,j]**2*kxy[i,j-1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1] + kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1] + kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1] + kxy[i,j]*kxy[i+1,j]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kxx[i,j-1] + kxy[i,j-1]) + ((kxy[i,j]*(kxx[i,j-1]*kyy[i+1,j]*kxy[i,j] - kxy[i,j]*kxy[i+1,j-1]**2 + kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j] + kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j] + kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j] + kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kyy[i,j]*(kxx[i,j]*kxx[i,j-1]*kyy[i+1,j] - kxx[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j]*kxy[i+1,j-1]**2 - kxx[i+1,j-1]*kxy[i+1,j]**2 - kxx[i,j]*kxy[i+1,j-1]**2 + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kyy[i,j-1] + kxy[i,j-1]) + ((kxx[i,j]*(kyy[i,j]*kxy[i-1,j]*kxy[i-1,j-1] + kyy[i-1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i-1,j]*kxy[i-1,j-1] + kyy[i-1,j-1]*kxy[i,j]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j]*(kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1] - kxy[i-1,j]**2*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kxx[i,j-1] - kxy[i,j-1]) + ((kxx[i,j]*(kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j] - kxy[i,j]*kxy[i-1,j-1]**2 + kxx[i,j-1]*kyy[i-1,j]*kxy[i,j] + kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j] + kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j] + kxy[i-1,j]*kxy[i-1,j-1]*kxy[i,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kxy[i,j]*(kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j] - kxx[i-1,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kxy[i-1,j]**2 - kxx[i-1,j]*kxy[i-1,j-1]**2 + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kyy[i,j-1] - kxy[i,j-1]) - ((kxy[i,j-1]*(kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1] - kxy[i-1,j]**2*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j]*kxy[i,j-1] + kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1] + kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]) - (kyy[i,j-1]*(kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j] - kxx[i-1,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kxy[i-1,j]**2 - kxx[i-1,j]*kxy[i-1,j-1]**2 + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]))/(kxy[i-1,j]**2*kxy[i,j-1]**2 + kxy[i,j]**2*kxy[i-1,j-1]**2 - kxx[i-1,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i-1,j]**2 - kxx[i-1,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i-1,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i-1,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i-1,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 - kxx[i,j]*kyy[i-1,j-1]*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i-1,j-1]**2 - kxx[i,j-1]*kyy[i-1,j-1]*kxy[i,j]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i-1,j]**2 + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i-1,j-1] + kxx[i-1,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i-1,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i-1,j-1]*kyy[i-1,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i-1,j-1]*kyy[i,j-1] - 2*kxy[i-1,j]*kxy[i,j]*kxy[i-1,j-1]*kxy[i,j-1]))*(kyy[i,j-1] - kxy[i,j-1])
			self.s8 = lambda i,j: ((kyy[i,j]*(kxx[i,j-1]*kxy[i,j]*kxy[i+1,j] + kxx[i+1,j-1]*kxy[i,j]*kxy[i+1,j] + kxx[i,j]*kxy[i,j-1]*kxy[i+1,j-1] + kxx[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i,j]*(kxx[i,j-1]*kyy[i,j]*kxy[i+1,j] - kxy[i+1,j]*kxy[i,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxy[i,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kyy[i+1,j-1] - kxy[i+1,j-1]) - ((kxx[i+1,j]*(kyy[i+1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j]*kxy[i+1,j]*kxy[i+1,j-1] + kyy[i+1,j-1]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i+1,j]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i+1,j]*(kxx[i,j]*kyy[i,j]*kxy[i+1,j-1] - kxy[i,j]**2*kxy[i+1,j-1] + kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1] + kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1] + kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1] + kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kxx[i+1,j-1] - kxy[i+1,j-1]) - ((kxy[i,j]*(kyy[i+1,j]*kxy[i,j]*kxy[i,j-1] + kyy[i,j]*kxy[i+1,j]*kxy[i+1,j-1] + kyy[i+1,j-1]*kxy[i,j]*kxy[i,j-1] + kyy[i,j-1]*kxy[i+1,j]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kyy[i,j]*(kxx[i,j]*kyy[i+1,j]*kxy[i,j-1] - kxy[i+1,j]**2*kxy[i,j-1] + kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1] + kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1] + kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1] + kxy[i,j]*kxy[i+1,j]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kxx[i+1,j-1] - kxy[i+1,j-1]) - ((kxx[i+1,j]*(kxx[i,j-1]*kyy[i,j]*kxy[i+1,j] - kxy[i+1,j]*kxy[i,j-1]**2 + kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j] + kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j] + kxy[i,j]*kxy[i,j-1]*kxy[i+1,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]) - (kxy[i+1,j]*(kxx[i,j]*kxx[i,j-1]*kyy[i,j] - kxx[i,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kxy[i,j]**2 - kxx[i,j]*kxy[i,j-1]**2 + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]))/(kxy[i,j]**2*kxy[i+1,j-1]**2 + kxy[i+1,j]**2*kxy[i,j-1]**2 - kxx[i,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j]*kxy[i,j]**2 - kxx[i,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 - kxx[i+1,j]*kyy[i,j-1]*kxy[i+1,j-1]**2 - kxx[i+1,j]*kyy[i+1,j-1]*kxy[i,j-1]**2 - kxx[i+1,j-1]*kyy[i,j-1]*kxy[i+1,j]**2 - kxx[i+1,j-1]*kyy[i+1,j-1]*kxy[i,j]**2 + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j] + kxx[i,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i+1,j]*kyy[i,j-1] + kxx[i,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i,j-1]*kyy[i,j-1]*kyy[i+1,j-1] + kxx[i+1,j]*kxx[i+1,j-1]*kyy[i,j-1]*kyy[i+1,j-1] - 2*kxy[i,j]*kxy[i+1,j]*kxy[i,j-1]*kxy[i+1,j-1]))*(kyy[i+1,j-1] - kxy[i+1,j-1])


	def getPerm(self,i,j,di,dj):
		''' Returns permeability coefficent in point (i,j)
		when considering the boundary to (i+di,j+dj)

		di is the increment in x direction
		dj is the increment in y direction '''

		kxx = self.kxx
		kyy = self.kyy
		kxy = self.kxy


		if self.stencil == 1:

			if di==0 and dj==0:
				return self.s1(i,j)+self.s2(i,j)+self.s3(i,j)+self.s4(i,j)+self.s5(i,j)+self.s6(i,j)+self.s7(i,j)+self.s8(i,j)
			elif di==1 and dj==0:
				return -self.s1(i,j)
			elif di==0 and dj==1:
				return -self.s3(i,j)
			elif di==-1 and dj==0:
				return -self.s5(i,j)
			elif di==0 and dj==-1:
				return -self.s7(i,j)
			elif di==1 and dj==1:
				return -self.s2(i,j)
			elif di==-1 and dj==1:
				return -self.s4(i,j)
			elif di==-1 and dj==-1:
				return -self.s6(i,j)
			elif di==1 and dj==-1:
				return -self.s8(i,j)

			else:
				return 0

		elif self.stencil == 0:

			M = np.array([[-0.5*kxy[i,j],0.25*(kxy[i+1,j]-kxy[i-1,j])+0.5*(kyy[i,j]+kyy[i,j+1]),0.5*kxy[i,j]],
			[0.25*(-kxy[i,j+1]+kxy[i,j-1])+0.5*(kxx[i-1,j]+kxx[i,j]), -(kxx[i,j]+kyy[i,j]+0.5*(kxx[i-1,j]+kxx[i+1,j]+kyy[i,j-1]+kyy[i,j+1])) ,0.25*(kxy[i,j+1]-kxy[i,j-1])+0.5*(kxx[i,j]+kxx[i+1,j])],
			[0.5*kxy[i,j],0.25*(-kxy[i+1,j]+kxy[i-1,j])+0.5*(kyy[i,j]+kyy[i,j-1]),-0.5*kxy[i,j]]])
			return M[1-dj][1+di]


	def prepare(self,i,j):
		'''This version only handles the 3x3 stencil case'''
		# picks out the varying coordinate on given boundary

		x = self.xd(i,j)[0]
		y = self.xd(i,j)[1]

		def sideDiagnostic(i,j):
			'''Returns which boundary side the point (i,j) belongs to.
			index 0,1 is coordinate axis, entry -1,1 denotes start- or endpoint'''
			D =[0,0] 
			if i == 0: D[0] = -1
			if i == self.m+1: D[0] = 1
			if j == 0: D[1] = -1
			if j == self.m+1: D[1] = 1
			return D

		diagToSide = lambda D: 2*(1-D.index(0)) + (D[1-D.index(0)]+1)//2
		
		p = self.li(i,j) # Lexicographic description of current position


		# Go through neighbors
		for di in [-1,0,1]:
			for dj in [-1,0,1]:
				# Get coefficent from stencil
				val = (1/self.dx**2) * self.getPerm(i,j,di,dj)
				#print('i= '+str(i)+', j= '+str(j)+'  di = '+str(di)+', dj= '+str(dj)+'  Value: '+str(val))
				# Check boundary status of point
				D = sideDiagnostic(i+di,j+dj)
				
				
				if 0 not in D:
					D[1]=0
				# Check if neighbor is on boundaries
				side = diagToSide(D)
				if D == [0,0]: side = None
				
				
				if side != None:	
					'''Handling of boundary cases'''
					if self.bTypes[side] == 0: # Diriclet
						self.b[p] -= self.bVals(x+di*self.dx,y+dj*self.dx)[side]*val

					elif self.bTypes[side] == 1: # Homogenous Neumann conditions
						assert self.bVals(x,y)[side] == 0
						#first order
						if self.neumannType == 1:
							self.A[p,p] += val
						if self.neumannType == 2:
							self.A[p,p] += (4/3)*val
							if i-di in range(1,self.m+1) and j-dj in range(1,self.m+1):
								self.A[p,self.li(i-di,j-dj)] -= (1/3)*val
						
					else:
						raise TypeError('Impossible!')

				elif side == None:
					'''Handling of inner points'''
					self.A[p,self.li(i+di,j+dj)] += val
					
				else:
					raise TypeError('Impossible!')
		self.d[p] = self.b[p]
		self.b[p] += self.f(x,y)
		
	def solve(self):
		'''Solves the equation numerically, when the coefficents have been computed'''

		for i in range(1,self.m+1):
			for j in range(1,self.m+1):
				self.prepare(i,j)

		v = np.linalg.solve(self.A,self.b)
		end = self.m+1
		

		# Translates back to matrix form
		max_diff = 0
		l2_diff = 0
		for i in range(1,self.m+1):
			for j in range(1,self.m+1):
				p = self.li(i,j)

				# Sets the exact solution matrix
				exact = self.p_ex(self.xd(i,j)[0],self.xd(i,j)[1])
				self.w_ex[i,j] = exact

				# Sets the approximate solution matrix
				self.w[i,j]=v[p]
			
				if abs(exact-v[p])>max_diff: # Stores largest deviation
					max_diff = abs(exact-v[p])

				l2_diff += (exact - v[p])**2 * self.dx**2

		for j in range(0,self.m+2):
			# Fills exact values for left and right sides
			x_left = self.xd(0,j)[0]; y_left = self.xd(0,j)[1]
			x_right = self.xd(end,j)[0]; y_right = self.xd(end,j)[1]
			self.w_ex[0,j] = self.p_ex(x_left,y_left)
			self.w_ex[end,j] = self.p_ex(x_right,y_right)

			# Left side
			if self.bTypes[0] == 0:
				self.w[0,j] = self.bVals(x_left,y_left)[0]
			elif self.bTypes[0] == 1:
				if self.neumannType == 0:
					self.w[0,j] = self.w[1,j]
				elif self.neumannType == 1:
					self.w[0,j] = (4/3) *self.w[1,j] - (1/3) * self.w[2,j]

			# Right side
			if self.bTypes[1] == 0:
				self.w[end,j] = self.bVals(x_right,y_right)[1]
			elif self.bTypes[1] == 1:
				if self.neumannType == 0:
					self.w[end,j] = self.w[end-1,j]
				elif self.neumannType == 1:
					self.w[end,j] = (4/3)*self.w[end-1,j] - (1/3) * self.w[end-2,j]

		for i in range(0,self.m+2):
			# Fills exact values for bottom and top sides
			x_down = self.xd(i,0)[0]; y_down = self.xd(i,0)[1]
			x_up = self.xd(i,end)[0]; y_up = self.xd(i,end)[1]
			self.w_ex[i,0] = self.p_ex(x_down,y_down)
			self.w_ex[i,end] = self.p_ex(x_up,y_up)

			# Downside
			if self.bTypes[2] == 0:
				self.w[i,0] = self.bVals(x_down,y_down)[2]
			elif self.bTypes[2] == 1:
				if self.neumannType == 0:
					self.w[i,0] = self.w[i,1]
				elif self.neumannType == 1:
					self.w[i,0] = (4/3) *self.w[i,1] - (1/3) * self.w[i,2]

			# Upside
			if self.bTypes[3] == 0:
				self.w[i,end] = self.bVals(x_up,y_up)[3]
			elif self.bTypes[3] == 1:
				if self.neumannType == 0:
					self.w[i,end] = self.w[i,end-1]
				elif self.neumannType == 1:
					self.w[i,end] = (4/3)*self.w[i,end-1] - (1/3) * self.w[i,end-2]

		
		if self.counter>0:
			self.q_value = (np.log10(self.max_diff[0])-np.log10(max_diff[0]))/(np.log10(self.dx_old)-np.log10(self.dx))
			self.q_l2 = (np.log10(self.l2_diff[0])-np.log10(np.sqrt(l2_diff)))/(np.log10(self.dx_old)-np.log10(self.dx))
		else:
			self.q_value = 0
			self.q_l2 = 0
		self.counter = 1
		self.dx_old = self.dx
		self.max_diff = max_diff
		self.l2_diff = np.sqrt(l2_diff)
		self.max_bw_error = np.amax(abs(self.b-self.A*v))
		self.magnification = (max_diff/np.amax(abs(self.w_ex)))*(self.max_bw_error/np.amax(abs(self.b)))

class Solution:
	def __init__(self, f, p_exact,k=lambda x,y: [1,1,0],bTypes=None,bVals=None,bounds=[[0,1],[0,1]]):
		'''Defining an exact solution to the f = div(k*grad(p)) equation in order to study the difference with the numerical one.'''

		self.nArray = range(9,50,10) # Grid sizes to test
		self.p_exact = p_exact # Function in x and y defined over the interval
		self.f = f # Source term , function in x and y
		self.perm = 0

		# The mesh over which the numerical solution is done
		self.sys = Mesh(self.nArray[0],k=k,bounds=bounds)

		if bTypes != None and bVals != None: # if they are None, the mesh uses standard boundary conditions
			self.sys.bTypes=bTypes
			self.sys.bVals=bVals
		if k != None:
			self.sys.kFunc = k

		self.sys.setSource(f,p_exact)

	def solve(self,n,stencil=0):
		self.sys.changeDimension(n,stencil,self.perm)
		self.sys.solve()

	def convEx(self,stencil,dim):
		'''Measures convergence by comparing with exact solution'''
		errSeq = [] # Measures max-error at each gridsize
		errSeq2 = [] # Measures l2-error at each gridsize

		# Stepwise increase the grid size:
		for n in self.nArray:
			self.sys.changeDimension(n,stencil)
			self.sys.solve() # Solve for each size

			errSeq += [self.sys.max_diff]
			errSeq2 += [self.sys.l2_diff]

		self.errSeq = errSeq
		self.errSeq2 = errSeq2

		return errSeq

	def check(self,stencil=0,dim=2):
		errSeq = self.convEx(stencil,dim)
		#print(self.errSeq2)
		hArray = [1/(x+1) for x in self.nArray]
		plt.loglog(hArray,self.errSeq,basex=10,basey=10)
		plt.loglog(hArray,self.errSeq2,basex=10,basey=10)
		plt.loglog(hArray,[h**2 for h in hArray])
		plt.grid(True,which="both")
		plt.ylabel('Error')
		plt.xlabel('h')
		plt.legend([r'$\epsilon^{num}_{max}$',r'$\epsilon^{num}_{l_2}$',r'$\epsilon \propto h^2$'])
		plt.show()


def main():
	
	pi = np.pi

	# Test for perm in x and y (full tensor)
	p_red = lambda x,y: np.sin(0.5*pi*y)*x**2
	t_xx = lambda x,y: np.sin(0.5*pi*y)*(2*np.log(x+1)+2*x/(x+1))
	t_yy = lambda x,y: (x**2*pi*np.cos((pi*y)/2))/(2*(y + 1)) - (x**2*pi**2*np.log(y + 1)*np.sin((pi*y)/2))/4
	t_xy = lambda x,y: 0.5*pi*np.cos(0.5*pi*y)*(2*x*np.log(x+1)*np.log(y+1)+x**2*np.log(y+1)/(x+1))
	t_yx = lambda x,y: 2*x*(np.sin(0.5*pi*y)*np.log(x+1)/(y+1) + 0.5*pi*np.cos(0.5*pi*y)*np.log(x+1)*np.log(y+1))
	f_with_k = lambda x,y: t_xx(x,y) + t_yy(x,y)
	k_red = lambda x,y: [np.log(x+1),np.log(y+1),0]
	bTypes_red = [0,0,0,0]
	bVals_red = lambda x,y: [0,np.sin(0.5*pi*y),0,x**2]
	sol_red = Solution(f_with_k,p_red,k=k_red,bTypes=bTypes_red,bVals=bVals_red)

	# Tests the solution with different stepsizes to see the order of error
	sol_red.check(stencil=0)

	

	
	
if __name__ == '__main__':
	main()